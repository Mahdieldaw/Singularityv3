# Query: synthesis
# Including: ui/
# Excluding: .md, .txt
# ContextLines: 1

31 results - 14 files

ui\components\AiTurnBlock.tsx:
   87    const onClipClick = useCallback(
   88:     (type: "synthesis" | "mapping" | "antagonist", pid: string) => {
   89        void handleClipClick(aiTurn.id, type, pid);

   94  
   95:   // Filter activeRecomputeState to only include synthesis/mapping (AiTurnBlock doesn't handle batch)
   96    const activeRecomputeState = useMemo(() => {

  103  
  104:   // Use global synthesis provider, or fall back to the provider used for generation
  105:   const activeSynthesisClipProviderId = aiTurn.meta?.synthesizer;
  106  

ui\components\ChatInput.tsx:
  423              onCrownMove={(pid) => {
  424:               // No-op for synthesis provider now
  425:               setProviderLock('synthesis', true);
  426              }}

  438  
  439:       {/* Main chat input container - wider to match/exceed synthesis bubble width */}
  440        <div className="flex gap-2 items-center relative w-full max-w-[min(900px,calc(100%-24px))] p-2.5 bg-surface border border-border-subtle/60 rounded-t-2xl rounded-b-2xl flex-wrap z-[100] shadow-elevated">

ui\components\CouncilOrbsVertical.tsx:
  47      // Condition for trust button
  48:     const showTrustButton = !!(refinerOutput?.gem || refinerOutput?.synthesisPlus);
  49      const isTrustActive = activeProviderId === '__trust__';

ui\components\DecisionMapSheet.tsx:
  192      if (s === 'S' || s === 's') {
  193:       // For synthesizer, return the synthesis provider from metadata or use gemini as fallback
  194        const synthProviderId = citationSourceOrder?.['S'] || 'gemini';

ui\components\PipelineErrorBanner.tsx:
  34          switch (type) {
  35:             case 'mapping': return 'Synthesis and advanced insights require a successful cross-reference of multiple sources.';
  36              case 'refiner': return 'We couldn\'t generate additional insights or actions for this response.';

ui\components\refinerui\RefinerCardsSection.tsx:
  17   * Renders a compact summary of critical signals.
  18:  * Intended for insertion directly below the synthesis bubble in the chat stream.
  19   */
  20: export const RefinerSynthesisAccuracy: React.FC<RefinerSectionProps> = ({ output, className = "" }) => {
  21      const { blockerSignals, riskSignals } = categorizeSignals(output.signals);

ui\components\refinerui\RefinerDot.tsx:
  51                  `}
  52:                 aria-label={hasGem ? "View gem insight" : "View synthesis+"}
  53              >

ui\components\refinerui\TrustSignalsPanel.tsx:
    2   * TrustSignalsPanel - Simplified for new RefinerOutput structure.
    3:  * Now displays only SynthesisPlus content with attribution click handling.
    4   */

  132            <span className="text-lg">âœ¨</span>
  133:           <span className="font-semibold text-text-primary">Synthesis+</span>
  134          </div>

  191  
  192:         {refiner?.synthesisPlus ? (
  193            <div className="prose prose-sm max-w-none dark:prose-invert">
  194              <div className="text-text-primary leading-relaxed">
  195:               {parseAttributions(refiner.synthesisPlus, handleModelClick)}
  196              </div>

  199            <div className="flex items-center justify-center gap-2 text-text-muted py-8">
  200:             <span className="italic">Generating Synthesis+...</span>
  201              <span className="streaming-dots" />

  204            <div className="text-text-muted italic text-center py-8">
  205:             No enhanced synthesis available.
  206            </div>

ui\hooks\useRefinerOutput.ts:
   76              // Check for richer data using new structure
   77:             const hasRicher = !!current?.output?.synthesisPlus ||
   78                  !!current?.output?.gem ||

  108                          // Check for richer data using new structure
  109:                         const richer = !!parsed.synthesisPlus ||
  110                              !!parsed.gem ||

ui\hooks\chat\useChat.ts:
  308           * CRITICAL FIX: Transform backend "rounds" format
  309:          * Backend sends: { userTurnId, aiTurnId, user: {...}, providers: {...}, synthesisResponses, mappingResponses }
  310           */

ui\hooks\chat\usePortMessageHandler.ts:
   41   * CRITICAL: Step type detection must match backend stepId patterns
   42:  * Backend generates: 'batch-<timestamp>', 'synthesis-<provider>-<timestamp>', 'mapping-<provider>-<timestamp>'
   43   */

   64  /**
   65:  * Extract provider ID from stepId for synthesis/mapping steps
   66:  * Backend format: 'synthesis-gemini-1234567890' or 'mapping-chatgpt-1234567890'
   67   */

  383  
  384:           // Some backends omit providerId for synthesis/mapping partials; derive from stepId if needed
  385            let pid: string | null | undefined = providerId;

  827                status: 'queued' | 'active' | 'streaming' | 'completed' | 'failed',
  828:               phase: 'batch' | 'synthesis' | 'mapping'
  829              ) => {
  830                if (status === 'queued') return 'idle';
  831:               if (status === 'active') return phase === 'synthesis' ? 'synthesizing' : 'thinking';
  832                if (status === 'streaming') return 'streaming';

ui\hooks\chat\useRoundActions.ts:
  559    /**
  560:    * Toggle synthesis provider selection for a specific user turn.
  561     * NOTE: This uses userTurnId as the key for backward compatibility with existing UI state.

ui\hooks\cognitive\useModeSwitching.ts:
  7  /**
  8:  * Hook to manage switching between cognitive views (Artifact Showcase vs Synthesis)
  9   * and triggering backend transitions if data isn't present yet.

ui\hooks\providers\useRetryProvider.ts:
  10        providerIds: string[],
  11:       retryScope: 'batch' | 'synthesis' | 'mapping' = 'batch'
  12      ) => {
